<?php
/**
 * Plugin Name: import news
 * Plugin URI: http://URI_Of_Page_Describing_Plugin_and_Updates
 * Description: input data for bios listings
 * Version: 3.2
 * Author: Leta
 * License: A "Slug" license name e.g. GPL2
 *
 * uses : https://github.com/WebDevStudios/Custom-Metaboxes-and-Fields-for-WordPress
 *
 * references: http://codex.wordpress.org/Plugin_API/Action_Reference/manage_$post_type_posts_custom_column
 *
 **/




function programmatically_import_news_storys() {

/**
 * $file = fopen( plugins_url( 'test.csv', __FILE__ ), "r" ); 
 * $an_arr = [];
 */
 
$an_arr = [];
$handle = fopen( plugins_url( 'test.csv', __FILE__ ), "r");
$row = 0;

if ( $handle !== FALSE) {
	while ( ( $data = fgetcsv($handle, 1000, ",") ) !== FALSE ) {
        $num = count( $data );
		
        for ( $c=0; $c < $num; $c++ ) {
	    	$an_arr[] = $data[$c];
	        } //end for
			$row++;
	   } //end while
	    fclose($handle);
} //end if
echo $num . "<br />";
//print_r($an_arr);

$post_id = -1;
$this_type = 'story';

for( $i=0; $i < $num; $i++ ){
	//foreach( $an_arr as $arr ) {
	//$title = $an_arr[$i][2][0];
	//$content = $an_arr[$i][11][0];
	
	if( null == get_page_by_title( $title ) ){
		$post_id = wp_insert_post(
		array(
		'post_title' => $title,
		'post_content' => 'hi',
		'post_type' => $this_type,
		'post_status' => 'publish',	
		)
		); //end insert post
	} else {
		$post_id = -2;
		}
}//end for loop

} //end funciton


add_filter( 'after_setup_theme', 'programmatically_import_news_storys' );
 
?>